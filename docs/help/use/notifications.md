---
title: 消息通知
---

华炎魔方目前支持站内消息、推送通知、邮件通知、短信通知等多种消息通知方式，有些消息通知方式有其特定使用场景及功能限制。

## 站内消息

华炎魔方支持站内消息通知，有新消息到达时，页面右上角会显示收到的消息列表及未读消息数量，且所有的站内消息都会发送 [推送通知](#推送通知)。

![站内消息通知](/assets/notification_unread.png)

点击通知图标，可以看到最新的站内通知消息，这里最多只显示最新的20条消息。

![站内消息通知](/assets/notification_list.png)

:::note 提示
[审批王](/help/workflow) 并没有集成站内消息功能，所以相关审批通知并不会显示在上述站内通知消息列表中，详细请见：[审批通知](#审批通知)。
:::

### 标准业务对象

以下标准业务对象已内置站内消息通知功能。

- **公告**：每条公告的“发布对象”属性关联的用户都会收到一条公告通知，当管理员把某个用户从公告的“发布对象”属性中移除时，该用户站内消息列表也会移除该公告消息，或者当公告被删除时，所有相关用户的站内消息列表都会移除该公告消息。
- **日程**：每个日程的“分派给”属性关联的用户都会收到一条日程通知，当管理员把某个用户从日程的“分派给”属性中移除时，该用户站内消息列表也会移除该日程消息，或者当日程被删除时，所有相关用户的站内消息列表都会移除该日程消息。
- **任务**：每个任务的“分派给”属性关联的用户都会收到一条任务通知，当管理员把某个用户从任务的“分派给”属性中移除时，该用户站内消息列表也会移除该任务消息，或者当任务被删除时，所有相关用户的站内消息列表都会移除该任务消息。
- **知识**：每个知识的“授权查看”属性关联的用户都会收到一条知识通知，当管理员把某个用户从知识的“授权查看”属性中移除时，该用户站内消息列表也会移除该知识消息，或者当知识被删除时，所有相关用户的站内消息列表都会移除该知识消息。

:::note 提示
当用户把任务“分派给”自己时，华炎魔方并不会给该用户发送相关站内消息，“日程”和“知识”也适用这种规则，但是“公告”是个例外，即公告的发布者可以在站内消息列表看到自己发布的消息通知。
:::

### 自定义业务对象

华炎魔方内置 [消息通知](https://github.com/steedos/steedos-platform/blob/1.23/packages/standard-objects/notifications.object.yml) 业务对象，要想给自定义业务对象集成站内消息功能，只要在需要发送站内消息通知时新建一条“消息通知”记录关联到某条自定义业务对象记录即可，华炎魔方会自动处理包括 [推送通知](#推送通知) 在内的一系列站内消息相关操作。

华炎魔方标准业务对象内置的站内消息通知功能也是基于上述“消息通知”业务对象，如果您想集成消息通知功能到自定义业务对象，需要编写 [触发器](/developer/object_trigger)，可以参考 [公告对象集成站内消息通知功能触发器源码](https://github.com/steedos/steedos-platform/blob/1.23/packages/standard-objects/announcements.trigger.js)。

## 推送通知

华炎魔方支持在手机APP客户端、PC客户端、Chrome浏览器上接收和显示推送消息。

### 站内消息通知

华炎魔方所有站内消息都会自动发送推送通知，华炎魔方大部分标准业务对象都是通过集成 [站内消息](#站内消息) 来实现推送通知的，如果您需要在华炎魔方标准业务对象或自定义业务对象上实现推送通知功能，我们推荐通过集成 [站内消息](#站内消息) 来实现。

### 审批通知

[审批王](/help/workflow) 作为华炎魔方早期的成熟应用，并没有集成 [站内消息](#站内消息)，但是它已经内置了相关推送通知功能。

- **待审核**：当待审核列表有收到新申请单时，华炎魔方会发送推送通知给相关用户。
- **传阅**：当收到传阅过来的申请单时，华炎魔方会发送推送通知给相关用户。
- **申请单已核准**：当申请单被核准时，华炎魔方会发送推送通知给相关用户。
- **申请单已驳回**：：当申请单被驳回时，华炎魔方会发送推送通知给相关用户。

## 邮件通知

在“设置->个人账户设置->我的资料”界面可以勾选“接收邮件通知”属性来设置当前用户是否接受邮件通知，目前此处设置只影响审批王应用的 [审批通知](#审批通知)，如果勾选，当审批王收到审批通知时，华炎魔方不只会给用户发送 [推送通知](#推送通知)，还会额外给用户发送邮件通知。

## 短信通知

在“设置->个人账户设置->我的资料”界面可以勾选“接收短信提醒”属性来设置当前用户是否接受短信通知，目前此处设置只影响审批王应用的 [审批通知](#审批通知)，如果勾选，当审批王收到审批通知时，华炎魔方不只会给用户发送 [推送通知](#推送通知)，还会额外给用户发送短信通知。
