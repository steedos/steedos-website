---
title: 累计汇总计算
---

累计汇总字段会计算相关记录中的值，例如相关列表中的值。您可以创建累计汇总字段，它可根据某个子表中的字段值，在主表中显示值。子表必须通过master/detail字段直接与主表相关。例如，您要在客户的发票相关列表中显示所有相关发票自定义对象记录的发票总金额。您可在名为“发票总金额”的自定义帐户字段中显示这一汇总信息。

可以使用累计汇总字段执行不同类型的计算。可以计算与主表相关的子表的数量。或者，您可以计算子表中字段的总和、最小值或最大值。

![汇总字段](/assets/platform/summary.png)

## 定义累计汇总字段：

- 在您希望显示字段的对象上创建自定义字段。 汇总字段汇总了相关对象上的记录中的值，因此该对象（您在上面创建了该字段）应位于详细页面，通过master/detail字段直接相关。
- 选择累计汇总字段类型，
- 输入一个字段标签和任何其他属性，
- 选择主表详细信息关联子表的对象。该对象包含您要汇总的记录。
- 如果要在汇总计算中包含所选记录组，请输入筛选条件。
- 单击保存结束操作。

<!-- ## 选择汇总类型：

- COUNT：相关记录的总数。
- SUM：对在要聚合的字段选项中选择的字段中的值进行加总。仅数字、金额和百分比字段可用。
- MIN：显示所有直接相关记录中在要聚合的字段选项中选择的字段的最小值。仅数字、金额、百分比、日期和日期/时间字段可用。
- MAX：显示所有直接相关记录中在要聚合的字段选项中选择的字段的最大值。仅数字、金额、百分比、日期和日期/时间字段可用。 -->

## 最佳实践

- 如果不想让用户看见累计汇总字段计算值，可以将字段设置为隐藏，或新建编辑时隐藏。用户不能看见的字段仍然会在累计汇总字段中被计算。
- 如果具有验证规则，请考虑它们将如何影响累计汇总字段。详细记录中的值发生变更时，累计汇总字段中的值也会发生变更。所以保存详细记录或主记录时会显示一个验证错误。
- 因为累计汇总字段不在编辑页面上显示，所以您可以在验证规则中使用它们，但它不作为验证的错误位置。
- 避免从子字段引用累计汇总字段。从子记录引用的累计汇总字段可以拥有过时值，因为父级记录尚未更新。而是，从父级记录中引用累计汇总字段。您的累计汇总字段将始终拥有更新值，因为该规则在父值被更新后运行。如果您尝试在父累计汇总字段上施加 25 的记录限制，在子对象上创建验证规则。当您添加子记录时，子对象上的验证规则可以检查计数是否已经为 25 或更大。

```yaml
AND(ISNEW(), Sample.Line_Count__c >= 25)
```

- 累计汇总字段中不允许自动派生字段，如当前日期或当前用户。禁止字段包含可动态派生值的函数（如 DATEVALUE、NOW 和 TODAY）的公式字段。累计汇总字段中也不允许包含相关对象合并字段的公式字段。