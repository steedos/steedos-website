---
title: 打印模板概述
sidebar_label: 概述
---

## 什么是打印模板？

打印模板是华炎魔方提供的一种通过配置模板脚本来提取数据库中指定数据并自动把这些数据精确写入到您精心准备的Word文档指定位置的功能。

## 什么时候需要打印模板？

有时我们会需要把在华炎魔方界面上看到的列表或详细记录信息整理成Word文档供打印，只要简单配置下，我们的打印模板功能就能帮您把任何在华炎魔方界面上看到的数据导出为Word模板以供打印或分享给其他人。
比如您可能需要用Word文档整理并打印出某个报价单详细信息，包括其附件列表，报价行条目，批准历史在内的所有信息可能都需要体现在Word文档中，如果手工整理该文档不但耗时耗力，而且有可能出现错误或遗漏部分内容。

再比如您可能基于华炎魔方已经实现了某个项目需求，客户希望您把该项目的所有数据库表，包括各个表字段信息在内的所有数据建模相关信息都整理出来通过邮件发送给对方，您肯定不会很乐意手工整理这些信息；现在，有了华炎魔方独创的打印模板功能，您只需要花费几分钟时间就可以很方便的把您需要的信息嵌入到您精心准备好的Word文档中。

:::note 提示
只有企业版支持此功能，关于如何购买许可证，请参考[许可证](https://www.steedos.com/help/company/license)。
:::

## 打印模板实现过程

打印模板功能是基于华炎魔方独特的GraphQL API强大的数据获取功能，用模板脚本来描述如何显示接口中获取到的相关数据，并通过把模板脚本嵌入到Word模板文件需要显示数据的位置来实现自动写入相关数据到Word模板指定位置。

以下是实现打印模板功能的几个核心操作步骤。

### 创建打印模板

请先创建一个打印模板记录，并把调式好的GraphQL脚本复制到其中，详情请参考 [如何创建打印模板？](/help/word_template/create)。

### 编写模板文件

请根据实际需求编写一个Word文件作为模板文件，您可以在Word文件中随意排版，也可以使用任何元素填充Word文件内容，比如图片、背影水印、表格、页眉页脚等，只要预留好需要显示数据的位置即可。

### 编写模板脚本

编写好Word模板文件之后，就可以开始在Word文件中编写模板脚本来把相关数据嵌入到之前预留好需要显示数据的位置上，详情请参考 [如何在Word模板文件中嵌入显示数据脚本？](/help/word_template/script)。

### 上传模板文件

模板文件写好后，需要把它与之前创建好的打印模板记录关联起来，只要在之前创建好的打印模板详细记录界面底部的附件列表中把它上传上去即可。

:::note 提示
每个打印模板只支持上传一个模板文件，当模板文件内容有变更需要重新上传时，需要把之前上传过的模板文件先删除掉。
:::

### 导出文件供打印

现在可以点击打印模板详细记录界面右上角的“打印”按钮来导出可直接打印的Word文件，如果看到右上角有报错信息，说明之前上传的模板文件中的模板脚本语法可能有问题，请检查并修正这些模板脚本内容然后重新上传修正好的模板文件。

点开该Word文件，检查之前在其中编写的模板脚本是否自动换成了相关数据，如果没有说明这些模板脚本语法可能有问题，需要重新编写并上传修正好的模板文件。

:::note 提示
如果发现导出的文件中有需要补充的数据，您可能不仅要修改模板文件中的模板脚本，也需要检查下打印模板中输入的GraphQL脚本是否也缺少相关字段信息。
:::

## 打印模板的限制

使用打印模板功能可以很方便的把数据库中相关数据自动写入到Word文件中，但是在一个打印模板记录中只能关联一个打印模板文件，虽然这个打印模板文件中可以通过模板脚本来嵌入数据库中任意对象的数据，但是它只能嵌入一个对象的数据，这个对象就是打印模板的“对象”属性中输入的对象API名称。

虽然一个打印模板只能把一个对象的数据嵌入到一个Word模板文件中，但是如果某份打印模板有嵌入多个对象数据的需求的话，您可以把这个打印模板先分拆成多个打印模板，并对应的准备多个Word模板文件，每个打印模板将分别导出一个嵌入各自对象数据的Word文件，最后你只需要手动把这些导出的Word文件整理合并成一个文件即可。
