---
title: 如何在Word模板文件中嵌入显示数据脚本？
sidebar_label: GraphQL脚本，引用变量
---

在Word模板文件中嵌入显示数据脚本之前，一定要明白怎么写变量和复合变量，怎么写循环，以及`__label`后缀变量的使用规则。最后再根据GraphQL客户端控制台返回的结果，在Word模板文档里面写入变量。

- 变量：在Word模板文档中可以把字段名包裹在一对大括号中来表示变量，变量写法是“{字段名}”，它将输出该变量对应的值，如某产品报价编号写作`{quote_number}`，显示结果`0000001`。

- 相关表变量：需要引用相关表变量的时候，用点符号"."连接各个对象字段以形成引用链，如`{owner.name}`或`{owner.mobile}`,表示主表引用子表的`name`或`mobile`数据，相关表变量理论上支持无限层级的引用，但是出于性能考虑请避免引用层级过多。

- `__label`后缀变量：只支持日期，日期时间，布尔型等字段类型。如`created__label`表示创建时间，返回的结果为`2020-12-22 15:17`。如果直接写作`created`，会返回为`1608621469293`类似的数据。

循环变量

```yml
GraphQL脚本写法示例                                    
{                                                                      {#quote}  
  quote {                                                           
    name                                                              
    quote_number                                                 
    status                                                            
    }                                                                    .          
}                                                                       
```

Word模板文档主表写法示例

```yml
{#quote}
......
{name}
{quote_number}
{status}
.....
{/quote}
```

Word模板文档子表写法示例

```yml
{#quote}
......
{#related__quote_line_item}{product_id.name}
......
{total_price}{/related__quote_line_item}  
......
{/quote}             
```

Word模板文档循环变量写法为:{#对象}......{/对象}，“#”表示循环开始，“/”表示循环结束，都要用“{}”括起来。注意：子表一定要包含在主表内。

脚本入口：如果GraphQL客户端控制台右侧窗口返回的结果是您想要获取的数据，则在Word模板文档中根据变量相关语法嵌入GraphQL脚本。Word模板文档整理完成后，在打印模板下方点击上传按钮，上传Word模板文档附件即可完成打印。详情请参考打印报价单详细信息。
